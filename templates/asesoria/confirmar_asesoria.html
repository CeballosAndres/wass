{% include 'root.html' %}
{% load static %}
{% load widget_tweaks %}

{% load auth_extras %}

{% block content %}

<main class="container">

    <div class="row my-3">
        <div class="col pl-4">
          <p class="text-secondary">Verifique la información y en caso de ser necesario, añada los datos faltantes.</p>
        </div> 
      </div>
      
    <div class="card container m-6 bg-light my-3"> 
        <div class="row">
            <div class="col my-3 text-center">
                <h4 class="text-muted">Detalles de la asesoría</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-md-2 text-center m-auto">
                <img src="{% static 'images/user.svg' %}" width="75" alt="foto de perfil">
            </div>
            <div class="col">
                <ul class="info">
                    <li>{% if request.user|has_group:"asesorados" %}
                        <strong>Asesor:</strong>   
                            {% if asesoria.asesor.nombre %}
                                {{asesoria.asesor.nombre}}
                                {% else %}
                                {{asesoria.asesor}}
                            {% endif %}
                        {% else %}
                        <strong>Alumno:</strong> {{asesoria.asesorado.nombre}}
                        {% endif %}
                    </li>
                    <li><strong>Tema:</strong> {{ asesoria.subtema.nombre }}</li>
                    <li><strong>Lugar:</strong>
                        {% if asesoria.asesor.lugar_asesoria %}
                        {{asesoria.asesor.lugar_asesoria}}
                        {% else %}
                        Acordar con el asesor.
                        {% endif %}
                    </li>
                    {% if asesoria.fecha_solicitud %}
                        <li><strong>Fecha de solicitud:</strong> {{ asesoria.fecha_solicitud|date:"l d M Y" }} {{ asesoria.fecha_solicitud|time:"H:i" }}</li>
                    {% endif %}
                    <li><strong>Fecha de asesoría:</strong> {{ asesoria.fecha_asesoria|date:"l d M Y" }} {{ asesoria.fecha_asesoria|time:"H:i" }}</li>
                </ul>
            </div>
        </div>
    

    {% if entrada %}
    <div class="row m-3">
        <div class="col mt-3">
            <form method="post" action="">
                {% csrf_token %}
                <div class="form-group">
                    <label class="lead" for="razones">{{ entrada }}</label>
                    {% if form.comentario_finalizada %}
                    {% render_field form.comentario_finalizada class="form-control" rows="3" %}
                    {% endif %}
                    {% if form.razon_cancelada %}
                    {% render_field form.razon_cancelada class="form-control" rows="3" %}
                    {% endif %}
                    {% if form.razon_rechazada %}
                    {% render_field form.razon_rechazada class="form-control" rows="3" %}
                    {% endif %}
                    {% if form.descripcion %}
                    {% render_field form.descripcion class="form-control" rows="3" %}
                    {% endif %}
                    {% if form.requisitos %}
                    {% render_field form.requisitos class="form-control" rows="3" %}
                    {% endif %}
                    <div class="text-center">
                        <button type="submit" class="my-btn smaller mt-3">Confirmar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    {% else %}
        {% if asesoria.descripcion %}
        <div class="container m-6 bg-light">
            <div class="row">
                <div class="col mt-3">
                    <h4>Descripción de la asesoría</h4>
                    <p>{{ asesoria.descripcion }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% if asesoria.requisitos %}
        <div class="container m-6 bg-light">
            <div class="row">
                <div class="col mt-3">
                    <h4>Requisitos previos a la asesoría</h4>
                    <p>{{ asesoria.requisitos }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% if asesoria.razon_cancelada %}
        <div class="container m-6 bg-light">
            <div class="row">
            	<div class="col mt-3">
            	    <h4>Razón de cancelación</h4>
            	    <p>{{ asesoria.razon_cancelada }}</p>
            	</div>
            </div>
        </div>
        {% endif %}
        {% if asesoria.razon_rechazada %}
        <div class="container m-6 bg-light">
            <div class="row">
                <div class="col mt-3">
                    <h4>Razón de rechazo</h4>
                    <p>{{ asesoria.razon_rechazada }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% if asesoria.comentario_finalizada %}
        <div class="container m-6 bg-light">
            <div class="row">
                <div class="col mt-3">
                    <h4>Comentario final</h4>
                    <p>{{ asesoria.comentario_finalizada }}</p>
                </div>
            </div>
        </div>
        {% endif %}
    {% endif %}
    </div>
</main>


{% endblock %}